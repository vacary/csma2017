% ----------------------------------------------------------------------
% 13eme Colloque National en Calcul des Structures
% ----------------------------------------------------------------------
% 15-19 mai 2017, Presqu'ile de Giens
% ----------------------------------------------------------------------
\documentclass{CSMA2017}
% ----------------------------------------------------------------------
\title{Méthodes de Newton non--lisses pour les problèmes de contact frottant dans les systèmes de multi--corps flexibles.}
% ----------------------------------------------------------------------
\author{V. Acary$^1$, M. Brémond$^2$, F. Dubois$^1$}
% ----------------------------------------------------------------------
\address{%
$^1$ INRIA. Grenoble, \{vincent.acary,maurice.bremond\}@inria.fr\\
$^2$ LMGC, Université de Montpellier, frederic.dubois@umontpellier.fr \\
}

% Mettre vos commandes personneles ici
% ----------------------------------------------------------------------
% Les commances \vect et \tens sont définies dans le fichier CSMA2017.cls


\def\RR{\nbR}
\def\NN{\nbN}
\def\nbR{\ensuremath{\mathrm{I\!R}}} % IR
\def\nbN{\ensuremath{\mathrm{I\!N}}} % IN

\def\n{{\hbox{\tiny{N}}}}
\def\t{{\hbox{\tiny{T}}}}

\def\tone{{\hbox{\tiny{T}}}_{\hbox{\tiny{1}}}}
\def\ttwo{{\hbox{\tiny{T}}}_{\hbox{\tiny{2}}}}

\usepackage{tikz}
\usepackage{xkeyval,tkz-base}
\usetikzlibrary{arrows}
\usetikzlibrary{calc}

% ----------------------------------------------------------------------
\begin{document}
% ----------------------------------------------------------------------
\maketitle
% ----------------------------------------------------------------------

\begin{abstract}
Dans cette contribution, on se propose d'évaluer la performance des méthodes de Newton non--lisses dans le contexte des systèmes multi--corps flexibles (mécanismes, milieux granulaires ou milieux divisés) avec contact et frottement. Les méthodes itératives de type projection/relaxation (Jacobi ou Gauss--Seidel projeté) sont généralement utilisées pour leur propriétés de robustesse et de régularisation des systèmes fortement hyper--statiques. On montre que dans le cas des systèmes déformables, les méthodes de Newton permettent d'atteindre de grandes précisions a un coût beaucoup plus faible.

\keywords contact unilatéral, frottement de Coulomb, méthodes Newton non--lisses.
\end{abstract}

\section{Introduction}

Dans le contexte des systèmes multi--corps avec contact et frottement de Coulomb, le problème de contact frottant discret que l'on obtient a chaque pas de temps après une discrétisation temporelle, ou a chaque pas de chargement en quasi--statique, est généralement résolu par des méthodes itératives de type projection/relaxation (Jacobi ou Gauss--Seidel projeté). 
%
Pour les systèmes de corps rigides, qui sont pour la plupart fortement hyperstatique du fait d'un grand nombre de contacts en regard du nombre de degrés de liberté, les méthodes itératives jouissent de bonnes propriétés de robustesse. Elles permettent de converger de façon sure, mais lentement vers une solution du problème mais si les forces de réaction ne sont pas définies de manière unique. Il est connu que ces méthodes de Newton non--lisses sont totalement inopérantes pour les systèmes rigides hyperstatiques~\cite{bertailsdescoubes:inria-00557706, ??}.


Dans le cas de système de corps flexibles, discrétisés par exemple par des éléments finis, il est facile de réduire ce degré d'hyperstaticité en augmentant le nombre de degrés de liberté du système de façon à éviter les contraintes dépendantes au contact. Ceci peut par exemple se faire en raffinant les maillages a contact tout en contrôlant le nombre de point de contact générés.
%
Dans cette contribution, on montrer qu'il devient alors intéressant d'utiliser des méthodes de Newton non lisses pour résoudre le problème discret surtout si on veut atteindre des niveaux de précision relative supérieurs à $10^{-4}$.  Alors que les méthodes itératives de type projection/relaxation continuent à converger lentement, les méthodes de Newton retrouvent leurs convergences quadratiques locales pour des systèmes fortement réguliers. Cela permet d'atteindre des niveaux de précisions arbitraires pour un coût de calcul bien moindres. Dans ce travail, on essaye aussi de montrer qu'il peut être intéressant d'introduire \marginpar{voir si on peut le faire} un modèle de comportement élastique dans un système rigide afin de profiter des avantages d'un point de vue numériques des méthodes de Newton. Dans des travaux antérieurs, M. Jean~\cite{Jean1999,Acary.Jean98} avait montré que l'introduction de l'élasticité permettait de réduire le degré d'hyperstaticité et d'améliorer sensiblement la qualité des solutions en termes de forces de réaction. En préférant des méthodes de Newton non--lisses, on améliore aussi fortement le coût de calcul.


\paragraph{Formulation du problème}

Considérons un nombre  $n_c\in \NN$ de points de contact tridimensionnel et un nombre   $n\in\NN$ de degrés de liberté du système discret. Pour chaque contact $\alpha$, les vitesses relatives locales au contact notées  $u^\alpha\in\RR^3$ et les réactions au contact notées $r^\alpha\in\RR^3$ (forces ou impulsions) sont décomposées dans un repère local au contact $({\sf N}^\alpha,{\sf T_1}^\alpha,{\sf T_2}^\alpha)$ telles que  $u^\alpha = u^\alpha_{\n} {\sf N}^\alpha +   u^{\alpha}_{\tone}{\sf T_1}^\alpha + u^{\alpha}_{\ttwo}{\sf T_2}^\alpha , u^\alpha_{\n} \in \RR, u^\alpha_{\t} = [u^{\alpha}_{\tone},u^{\alpha}_{\ttwo}]^\top \in \RR^2$ and  $r^\alpha = r^\alpha_{\n} {\sf N}^\alpha +   r^{\alpha}_{\tone}{\sf T_1}^\alpha + r^{\alpha}_{\ttwo}{\sf T_2}^\alpha  , r^\alpha_{\n} \in \RR, r^\alpha_{\t}=[r^{\alpha}_{\tone},r^{\alpha}_{\ttwo}]^\top \in \RR^2$. L'interstice au contact est noté $g_\n^\alpha$ (voir la figure~\ref{fig:local-frame}).

\begin{figure}
  \centering
  \begin{tikzpicture}[ scale=3,
      axis/.style={ ->, >=stealth'},
      normal/.style={ thick, ->, >=stealth'},
      important line/.style={very thick},
      dashed line/.style={dashed, thin},
      every node/.style={color=black},
      soldot/.style={only marks,mark=*},
      holdot/.style={fill=white,only marks,mark=*}
      ]
      % body
      \node (BodyA) at (1,-1) {Body A};
      \fill[gray!20] (1,0) arc (0:-90:1);
      \fill[gray!20] (1,0) arc (90:180:1);
      \draw (1,0) arc (90:180:1);

      \node (BodyB) at (-1,1) {Body B};
      \draw (0,1) arc (0:-90:1);
      \fill[gray!20] (0,1) arc (90:180:1);
      \fill[gray!20] (0,1) arc (0:-90:1);

      % local frame
      \def\nlength{0.35};
      \coordinate (CA)  at  ({1.0-sqrt(2)/2.0},{-1.0+sqrt(2)/2.0});
      \node[] at  (CA) [below] {$\sf C_A$};
      \draw[holdot]  (CA) circle(0.05em);
      \draw[normal] (CA) -- ($(CA)+({-\nlength*sqrt(2)/2.0},{+\nlength*sqrt(2)/2.0 })$) node [right] {$\,\sf N$};
      \draw[normal] (CA) -- ($(CA)+({-\nlength*sqrt(2)/2.0},{-\nlength*sqrt(2)/2.0 })$) node [above] {$\sf T_1\quad$};
      \draw[dashed line] (BodyA) -- (BodyB);
      \draw[holdot] ($(CA)+({\nlength*sqrt(3)/2.0},{0.0})$) circle(0.2em);
      \node at ($(CA)+({\nlength*sqrt(3)/2.0},{0.0})$) [right]{$\sf T_2$};
      \draw[soldot] ($(CA)+({\nlength*sqrt(3)/2.0},{0.0})$) circle(0.02em);

      \coordinate (CB)  at  ({-1.0+sqrt(2)/2.0},{1.0-sqrt(2)/2.0});
      \node at  (CB) [above] {$\sf C_B$};
      \draw[holdot]  (CB) circle(0.05em);

      \draw[axis] (CA) -- (CB) node[midway, below left ] {$\sf g_\n$} ;
      
      % \draw[axis] (0,-0.4) -- (0,0.4) node(yline)[right] {$\sgn(x)$};
      % % lines
      % \draw[important line] (-0.4,-0.3) -- (0.   ,-.3);
      % \draw[important line] (0.0,0.3) --(.4,.3)  ;
      % \coordinate (O) at (0.0, 0.05);
      % \draw[fill] (O) circle (0.03em);
      % \draw (0.0,0.05) node[right]{$a$};
      % \draw (0.0,0.3) node[left]{$1$};
      % \draw (0.0,-0.3) node[right]{$-1$};
      % \draw[holdot] (0.0,0.3) circle (0.03em);
      % \draw[holdot] (0.0,-.3) circle (0.03em);
    \end{tikzpicture}
\caption{Repère local au contact}
\label{fig:local-frame}
\end{figure}

Pour chaque contact, on définit le cône de Coulomb comme le cone du second ordre suivant:
\begin{equation}
  \label{eq:CoulombCone}
  K^\alpha = \{r^\alpha \in \RR^3 \mid \|r^\alpha_\t\| \leq \mu^\alpha r^\alpha_n\}.
\end{equation}
où $\mu^\alpha$ est le coefficient de frottement du contact $\alpha$. Sous forme disjonctive, le contact unilatéral en vitesse avec du frottement de Coulomb peut s'écrire
\begin{equation}
  \label{eq:contact-disjunctive}
  \left\{\begin{array}{llr}
      r^\alpha = 0  &\text{ if } g^\alpha_{\n} > 0  & \text{(pas de  contact)}\\
      r^\alpha = 0,  u^\alpha_\n \geq 0   &\text{ if } g^\alpha_{\n} \leq 0 & \text{(décollage)} \\
      r^\alpha \in K^\alpha, u^\alpha =0 &\text{ if } g^\alpha_{\n} \leq 0 & \text{(adhérence)}  \\
      r^\alpha \in \partial K^\alpha,u^\alpha _\n=0,  \exists\,\beta > 0, u^\alpha_\t = -\beta r^\alpha_\t &\text{ if } g^\alpha_{\n} \leq 0 & \text{(glissement)}  \\
    \end{array}\right.
\end{equation}
En introduisant la vitesse relative locale modifiée $\hat u^\alpha = u^\alpha + \mu^\alpha \|u^\alpha_\t\| {\sf N}^\alpha$ due à~\cite{DeSaxce92}, le problème peut être reformulé de manière équivalente comme un problème de complémentarité du second ordre~\cite{DeSaxce92,Acary.ea_ZAMM2011} :
\begin{equation}
  \label{eq:contact-soccp}
  \left\{\begin{array}{ll}
      r^\alpha = 0  & \text{ if } g^\alpha_{\n} > 0  \\
      K^{\alpha,\star}\ni \hat u^\alpha \perp r^\alpha \in K^\alpha  & \text{ sinon. }\\
    \end{array}\right.
\end{equation}
Le cône $K^{\alpha,\star}$ est le cône dual de $K^\alpha$.

Suite à une discrétisation des équations du mouvement ou d'équilibre, et à une possible linéarisation, on peut relier les variables cinématiques $ {v} \in \RR^n$ aux effort de contact par une relation linéaire, ce qui nous conduit au problème linéaire de complémentarité suivant en cas de contact :
\begin{equation}\label{eq:soccp1-intro}
  \begin{array}{rcl}
    M v = {H} {r} + {f}, &
    u = H^\top v + w,  &
    \hat u = u + g(u) ,\\[1mm]
    &    K^\star \ni {\hat u} \perp r \in K,&
  \end{array}
\end{equation}
où $f\in RR^n$ est homogène à des efforts, $K$ est le produit cartésien de cônes pour chaque contact, 
\begin{equation}
  \label{eq:CC}
  K = \prod_{\alpha=1\ldots n_c} K^{\alpha}  = \prod_{\alpha=1\ldots n_c} \{r^\alpha, \|r^\alpha_\t \| \leq \mu^\alpha |r^\alpha_\n| \}
\end{equation}
et $K^\star$ son dual. La fonction $g(u)$ est une fonction non--lisse définie par 
\begin{equation}
g(u) = [[\mu^\alpha  \|u^\alpha_\t\| {\sf N}^\alpha]^\top, \alpha = 1\ldots n_c]^\top\label{eq:gg}. 
\end{equation}
La matrice $M \RR^{n \times n}$ est le plus souvent définie positive.


\paragraph{Rang de la matrice $H$} Attardons nous un moment sur la matrice $H \in \RR^{n\times 3n_c} $ qui relie les efforts de contact $r$ aux efforts généralisés et de façon duale les vitesse relatives au contact aux vitesses généralisées. 

\clearpage
\begin{itemize}
\item Description du problème de frottement discret
\item Problème de rang de H
\item Objectifs du papier
  \begin{enumerate}
  \item Comparaison performance NSGS/NSN sur des déformables et des rigides.
  \item Intérêt a passer en déformable pour ajouter des ddl.
  \end{enumerate}
\end{itemize}

\section{Méthodes numériques de résolution}

\section{Profils de perfomance}

\section{Comparaison sur des solides élastiques}

\subsection{La murette}
\subsection{Résultats}
\begin{figure}
  \centering
  \includegraphics{figure/LowWall_FEM.1e-3.with_guess/simple/profile-LMGC_LowWall_FEM.pdf}
  \includegraphics{figure/LowWall_FEM.1e-3.with_guess/simple/profile-LMGC_LowWall_FEM_legend.pdf}
  \caption{Comparaison entre le solveur NSGS-AC et NSN-AC pour une précision de $10^{-3}$}
  \label{fig:LowWall_FEM.1e-3.simple}
\end{figure}
\begin{figure}
  \centering
  \includegraphics{figure/LowWall_FEM.1e-4.with_guess/simple/profile-LMGC_LowWall_FEM.pdf}
  \includegraphics{figure/LowWall_FEM.1e-4.with_guess/simple/profile-LMGC_LowWall_FEM_legend.pdf}
  \caption{Comparaison entre le solveur NSGS-AC et NSN-AC pour une précision de $10^{-4}$}
  \label{fig:LowWall_FEM.1e-4.simple}
\end{figure}
\begin{figure}
  \centering
  \includegraphics{figure/LowWall_FEM.1e-6.with_guess/simple/profile-LMGC_LowWall_FEM.pdf}
  \includegraphics{figure/LowWall_FEM.1e-6.with_guess/simple/profile-LMGC_LowWall_FEM_legend.pdf}
  \caption{Comparaison entre le solveur NSGS-AC et NSN-AC pour une précision de $10^{-6}$}
  \label{fig:LowWall_FEM.1e-6.simple}
\end{figure}


\begin{figure}
  \centering
  \includegraphics{figure/LowWall_FEM.1e-4.with_guess/nsn_nls/profile-LMGC_LowWall_FEM.pdf}
  \includegraphics{figure/LowWall_FEM.1e-4.with_guess/nsn_nls/profile-LMGC_LowWall_FEM_legend.pdf}
  \caption{Comparaison des solveurs NSN-*-NLS pour une précision de $10^{-4}$}
  \label{fig:LowWall_FEM.1e-4.nsn_nls}
\end{figure}
\begin{figure}
  \centering
  \includegraphics{figure/LowWall_FEM.1e-4.with_guess/nsgs/profile-LMGC_LowWall_FEM.pdf}
  \includegraphics{figure/LowWall_FEM.1e-4.with_guess/nsgs/profile-LMGC_LowWall_FEM_legend.pdf}
  \caption{Comparaison des solveurs NSGS pour une précision de $10^{-4}$}
  \label{fig:LowWall_FEM.1e-4.nsgs}
\end{figure}

\section{Comparaison sur des solides rigides}

\section{Utilisation des solides élastiques pour améliorer la convergence}

\section{Conclusion}

parralelisme.
\subsection{Références bibliographiques}

% Les références sont à insérer en fin de document, numérotées par ordre alphabétique des auteurs. Trois exemples de références sont proposés : un article \cite{article} et un acte \cite{acte} et un livre  \cite{livre}.


\bibstyle{plain}

\bibliography{biblio}

% % ----------------------------------------------------------------------
% \begin{thebibliography}{1}
% % ----------------------------------------------------------------------
% \bibitem{article}
% P. Auteur, D. Auteur, T. Auteur. \emph{Titre de l'article}, Revue, Éditeur, page1-pageN, Année. 
% \bibitem{acte} P. Auteur. \emph{Titre de l'acte}, Titre de l'ouvrage, Éditeur, page1-pageN, Année.
% \bibitem{livre} P. Auteur, D. Auteur. \emph{Titre de l'ouvrage}, Éditeur, Année. 

% % ----------------------------------------------------------------------
% \end{thebibliography}
% % ----------------------------------------------------------------------

% ----------------------------------------------------------------------
\end{document}
% ----------------------------------------------------------------------
